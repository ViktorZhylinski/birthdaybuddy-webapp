<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BirthdayBuddy - Telegram Import</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .container {
            text-align: center;
            max-width: 400px;
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .logo {
            font-size: 48px;
            margin-bottom: 20px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 16px;
            opacity: 0.8;
            margin-bottom: 30px;
        }
        
        .button {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            width: 100%;
            max-width: 250px;
        }
        
        .button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.1);
            display: none;
        }
        
        .status.success {
            background: rgba(0, 255, 0, 0.2);
            border: 1px solid rgba(0, 255, 0, 0.3);
        }
        
        .status.error {
            background: rgba(255, 0, 0, 0.2);
            border: 1px solid rgba(255, 0, 0, 0.3);
        }
        
        .status.info {
            background: rgba(0, 123, 255, 0.2);
            border: 1px solid rgba(0, 123, 255, 0.3);
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .contacts-list {
            text-align: left;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .contact-item {
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin: 5px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .contact-name {
            font-weight: bold;
        }
        
        .contact-birthday {
            font-size: 12px;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">üöÄ</div>
        <div class="title">BirthdayBuddy Import</div>
        <div class="subtitle">–ò–º–ø–æ—Ä—Ç–∏—Ä—É–π –¥–Ω–∏ —Ä–æ–∂–¥–µ–Ω–∏—è –¥—Ä—É–∑–µ–π –∏–∑ Telegram</div>
        
        <button class="button" id="connectBtn" onclick="connectTelegram()">
            –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Telegram
        </button>
        
        <button class="button" id="importBtn" onclick="importContacts()" disabled>
            –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç—ã
        </button>
        
        <div id="status" class="status">
            <div id="statusText"></div>
        </div>
        
        <div id="contactsList" class="contacts-list" style="display: none;"></div>
    </div>
    
    <script>
        let isConnected = false;
        let importedContacts = [];
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('BirthdayBuddy Web App loaded');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Telegram Web App
            if (window.Telegram && window.Telegram.WebApp) {
                console.log('Telegram Web App API –¥–æ—Å—Ç—É–ø–µ–Ω');
                showStatus('Telegram Web App API –∑–∞–≥—Ä—É–∂–µ–Ω', 'info');
            } else {
                console.log('Telegram Web App API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - —Ä–∞–±–æ—Ç–∞–µ–º –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ');
                showStatus('–†–∞–±–æ—Ç–∞–µ–º –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ', 'info');
            }
        });
        
        function connectTelegram() {
            const connectBtn = document.getElementById('connectBtn');
            const importBtn = document.getElementById('importBtn');
            
            connectBtn.disabled = true;
            showStatus('<span class="loading"></span>–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Telegram...', 'info');
            
            setTimeout(() => {
                if (window.Telegram && window.Telegram.WebApp) {
                    try {
                        window.Telegram.WebApp.ready();
                        window.Telegram.WebApp.expand();
                        isConnected = true;
                        
                        connectBtn.textContent = '‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ';
                        importBtn.disabled = false;
                        showStatus('‚úÖ –£—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ Telegram!', 'success');
                        
                        console.log('Telegram Web App –ø–æ–¥–∫–ª—é—á–µ–Ω');
                    } catch (error) {
                        showStatus('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ' + error.message, 'error');
                        connectBtn.disabled = false;
                    }
                } else {
                    // –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
                    isConnected = true;
                    connectBtn.textContent = '‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ (—Ç–µ—Å—Ç)';
                    importBtn.disabled = false;
                    showStatus('‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ', 'success');
                }
            }, 1500);
        }
        
        async function importContacts() {
            const importBtn = document.getElementById('importBtn');
            importBtn.disabled = true;
            showStatus('<span class="loading"></span>–ò–º–ø–æ—Ä—Ç –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤...', 'info');
            
            try {
                // –°–∏–º—É–ª—è—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞ –∫ Telegram API
                const contacts = await simulateTelegramContactsFetch();
                
                importedContacts = contacts;
                displayContacts(contacts);
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
                if (window.Telegram && window.Telegram.WebApp) {
                    window.Telegram.WebApp.sendData(JSON.stringify({
                        action: 'contacts_imported',
                        contacts: contacts,
                        count: contacts.length
                    }));
                }
                
                showStatus(`‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ ${contacts.length} –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ —Å –¥–Ω—è–º–∏ —Ä–æ–∂–¥–µ–Ω–∏—è!`, 'success');
                importBtn.textContent = '‚úÖ –ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à—ë–Ω';
                
            } catch (error) {
                showStatus('‚ùå –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞: ' + error.message, 'error');
                importBtn.disabled = false;
            }
        }
        
        async function simulateTelegramContactsFetch() {
            // –°–∏–º—É–ª—è—Ü–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏ API
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã —Å –¥–Ω—è–º–∏ —Ä–æ–∂–¥–µ–Ω–∏—è
            return [
                {
                    id: '1',
                    firstName: '–ê–ª–µ–∫—Å–µ–π',
                    lastName: '–ò–≤–∞–Ω–æ–≤',
                    username: 'alex_ivanov',
                    phoneNumber: '+7 900 123-45-67',
                    birthday: '15.03.1990'
                },
                {
                    id: '2',
                    firstName: '–ú–∞—Ä–∏—è',
                    lastName: '–ü–µ—Ç—Ä–æ–≤–∞',
                    username: 'maria_petrova',
                    phoneNumber: '+7 900 234-56-78',
                    birthday: '22.07.1985'
                },
                {
                    id: '3',
                    firstName: '–î–º–∏—Ç—Ä–∏–π',
                    lastName: '–°–∏–¥–æ—Ä–æ–≤',
                    username: 'dmitry_sidorov',
                    phoneNumber: '+7 900 345-67-89',
                    birthday: '10.12.1992'
                },
                {
                    id: '4',
                    firstName: '–ï–ª–µ–Ω–∞',
                    lastName: '–ö–æ–∑–ª–æ–≤–∞',
                    username: 'elena_kozlova',
                    phoneNumber: '+7 900 456-78-90',
                    birthday: '05.01.1988'
                },
                {
                    id: '5',
                    firstName: '–ê–Ω–¥—Ä–µ–π',
                    lastName: '–ú–æ—Ä–æ–∑–æ–≤',
                    username: 'andrey_morozov',
                    phoneNumber: '+7 900 567-89-01',
                    birthday: '18.09.1995'
                }
            ];
        }
        
        function displayContacts(contacts) {
            const contactsList = document.getElementById('contactsList');
            contactsList.style.display = 'block';
            
            contactsList.innerHTML = contacts.map(contact => `
                <div class="contact-item">
                    <div>
                        <div class="contact-name">${contact.firstName} ${contact.lastName || ''}</div>
                        <div class="contact-birthday">üéÇ ${contact.birthday}</div>
                    </div>
                    <div>‚úÖ</div>
                </div>
            `).join('');
        }
        
        function showStatus(message, type) {
            const status = document.getElementById('status');
            const statusText = document.getElementById('statusText');
            
            statusText.innerHTML = message;
            status.className = `status ${type}`;
            status.style.display = 'block';
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ–º info —Å—Ç–∞—Ç—É—Å —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            if (type === 'info') {
                setTimeout(() => {
                    if (status.className === `status ${type}`) {
                        status.style.display = 'none';
                    }
                }, 3000);
            }
        }
    </script>
</body>
</html>
